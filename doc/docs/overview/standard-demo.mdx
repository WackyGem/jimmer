---
sidebar_position: 2
title: Standard example
---

import {ViewMore} from '@site/src/components/ViewMore';
import {CacheConsistencyPanel} from '@site/src/components/HomepageFeatures/CacheConsistency';
import {SwaggerAuthorize, GraphiqlHeaders} from '@site/src/components/Image';

:::warning
The original low-quality documentation is being completely rewritten and will eventually become high-quality documentation.

However, after several months of hard work, only the Chinese part of the rewriting work has been completed, and the re-translation of the English document has not yet been completed.

Now that the translation of English documents has only started, we will speed up the translation process. Before that, you can read [Old english document](../old-en)
:::

:::tip
Running the example that comes with the framework directly is the most efficient way to familiarize yourself with Jimmer.
:::

## Be aware beforehand

Like strongly typed SQL DSL implementations such as [JOOQ](https://www.jooq.org/),[JPA2.0 Criteria](https://docs.oracle.com/javaee/6/tutorial/doc/gjitv.html),[QueryDSL](http://querydsl.com/),[MyBatis-Flex](https://github.com/mybatis-flex/mybatis-flex), [Fluent-MyBatis](https://github.com/atool/fluent-mybatis), Jimmer needs to generate more source code based on user code.

- In the case of Java, it's the annotation processor
- In the case of Kotlin, it is KSP

When user opens the a demo project for the first time using an IDE (such as Intellij), he will find that some classes that should have been automatically generated do not exist.

:::info
Don't be afraid at this time, click the run button and all errors will disappear automatically.
:::

## Example introduction

Jimmer provides supporting examples that are very helpful for quickly mastering Jimmer

General directory of all examples: https://github.com/babyfish-ct/jimmer/tree/main/example

The project provides 5 examples, each with two versions, Java and Kotlin, for a total of 10 examples.

<table>
    <thead>
        <th>Java</th>
        <th>Kotlin</th>
        <th>Description</th>
        <th>How to run</th>
        <th>importance</th>
    </thead>
    <tbody>
        <tr>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-core">java/jimmer-core</a></td>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-core-kt">java/jimmer-core-kt</a></td>
            <td>ORM agnostic example showing <a href="https://github.com/immerjs/immer">immer</a>-style immutable object</td>
            <td>Execute main method</td>
            <td>★★★★</td>
        </tr>
        <tr>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-sql">java/jimmer-sql</a></td>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-sql-kt">java/jimmer-sql-kt</a></td>
            <td>Leverage Jimmer to build REST services quickly. This example shows most of Jimmer's features and is the most important and basic example</td>
            <td>
                <ol>
                    <li>Execute main method</li>
                    <li>Access swagger page: http://localhost:8080/ui</li>
                    <li>Download TypeScript code：http://localhost:8080/ts.zip</li>
                </ol>
                <ViewMore buttonText="Notes" title="Considerations for jimmer-sql/jimmer-sql-kt" variant="outlined">
                    <p>If you need to use the feature of saving data, you need to set tenant in the HTTP header, otherwise it will cause an exception. </p>
                    <p>The tenants that are currently available in the database are `a` and `b`. Of course, for save operations, you can add new tenants. </p>
                    <p>Using the `swagger` UI as an example, you can set it up like this: </p>
                    <SwaggerAuthorize/>
                </ViewMore>
            </td>
            <td>★★★★★</td>
        </tr>
        <tr>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-sql-graphql">java/jimmer-sql-graphql</a></td>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-sql-graphql-kt">java/jimmer-sql-graphql-kt</a></td>
            <td>Leverage Jimmer to quickly build GraphQL services</td>
            <td>
                <ol>
                    <li>Execute main method</li>
                    <li>Access the UI of Graph<b>i</b>QL界面: http://localhost:8080/graph<b>i</b>ql</li>
                </ol>
                <ViewMore buttonText="Notes" title="Considerations for jimmer-sql-graphql/jimmer-sql-graphql-kt" variant="outlined">
                    <p>If you need to use the feature of saving data, you need to set tenant in the HTTP header, otherwise it will cause an exception. </p>
                    <p>The tenants that are currently available in the database are `a` and `b`. Of course, for save operations, you can add new tenants. </p>
                    <p>Using the `graphiql` UI as an example, you can set it up like this: </p>
                    <GraphiqlHeaders/>
                </ViewMore>
            </td>
            <td>★★</td>
        </tr>
        <tr>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-cloud">java/jimmer-cloud</a></td>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-cloud-kt">java/jimmer-cloud-kt</a></td>
            <td>Spring Cloud-based microservices project that showcases jimmer's remote association</td>
            <td>
                <ol>
                    <li>Start the registry-center, run the main method of the registry-center subproject</li>
                    <li>Start all microservices, run the main method in store-service, book-service, and author-service</li>
                    <li>Wait about half a minute to ensure that the registry-center correctly identifies all microservices and avoid exceptions that some swagger calls in the next step do not recognize the remote service. </li>
                    <li>
                        Access swagger-ui for any of the following microservices
                        <ul>
                            <li>store-service: http://localhost:7001/ui</li>
                            <li>book-service: http://localhost:7002/ui</li>
                            <li>author-service: http://localhost:7003/ui</li>
                        </ul>
                    </li>
                </ol>
            </td>
            <td>★</td>
        </tr>
        <tr>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/java/save-command">java/save-command</a></td>
            <td><a href="https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/save-command-kt">kotlin/save-command-kt</a></td>
            <td>Specific example for save command</td>
            <td>Run all unit test cases</td>
            <td>★★★</td>
        </tr>
    </tbody>
</table>

:::tip
The most important example to get started with is `jimer-sql`, and you can open either of these two examples according to your language preference

-   Java

    [example/java/jimmer-sql](https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-sql)

-   Kotlin

    [example/join/jimmer-sql-kt](https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-sql-kt)
:::

## Non-cached mode

Non-cached mode is the default operation mode for all examples, and all examples can be run directly without installing any external environment.

If an example depends on a database, it uses H2 memory data in non-cached mode and automatically creates the database at startup time.

As you can see, the non-cached mode is very simple and great for quickly familiarizing yourself with the example.

## Cache mode

The above 10 accompanying examples are presented, of which 4 can demonstrate Jimmer's caching and its consistency guarantees.

-   [java/jimmer-sql](https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-sql)和
    [kotlin/jimmer-sql-kt](https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-sql-kt)

-   [java/jimmer-sql-graphql](https://github.com/babyfish-ct/jimmer/tree/main/example/java/jimmer-sql-graphql)和
    [kotlin/jimmer-sql-graphql-kt](https://github.com/babyfish-ct/jimmer/tree/main/example/kotlin/jimmer-sql-graphql-kt)

By default, they do not use caching, run on an in-memory database and automatically initialize the database, which guarantees that there is no need to install any external environment, click the run button and demonstrate.

You can also have them start in cached mode, just run application with the spring-boot profile `maxwell` or `debezium`.

These two spring profiles utilize the CDC push capabilities of [maxwell] (https://maxwells-daemon.io/) or [debezium] (https://debezium.io/) to achieve <ViewMore buttonText="Cache coherency" variant="text" ><CacheConsistencyPanel/></ViewMore>, therefore, you need to install an external environment.

:::tip
In fact, using CDC push services such as [maxwell](https://maxwells-daemon.io/) or [debezium](https://debezium.io/) is not a the only way that can maintain the <ViewMore buttonText="cache consistency" variant="text">CacheConsistencyPanel</ViewMore>, Jimmer can do this is without the help of any outside technology.

- Jimmer's own ability to capture changes of database is called `TransactionTrigger`

- The ability to push database changes to jimmer through external CDC technology is called `BinLogTrigger`

See [Trigger type](.. /mutation/trigger#触发器类型).

`BinLogTrigger` has both better performance and better universality *(even if you bypass the API of the Jimmer to modify the database, you can modify the database in other ways, such as directly using the SQL IDE to modify the data, it can also be intercepted)*, which is the recommended solution.

So, while the `TransactionTrigger` can be implemented without any special external environment<ViewMore buttonText="cache coherency" variant="text"><CacheConsistencyPanel/></ViewMore>，
However, the official side example still uses the `BinLogTrigger` to synchronize the cache, which is the more recommended way.

So, we need to set up CDC services like maxwell or debezium to push database changes to jimmer.
:::

Enabling cached mode requires setting up an external environment.

1. First, you need to install docker locally

2. Install the external environment

The accompanying example supports two external environments, and you can choose one way to experience the <ViewMore buttonText="cache coherency" variant="text"><CacheConsistencyPanel/></ViewMore>

### Maxwell + MySQL

Although [maxwell](https://maxwells-daemon.io/) only supports MySQL, it is the simplest of all database change push techniques. Therefore, there is a demonstration value.

Open the command line, change to the local directory corresponding to [example/env-with-cache/maxwell](https://github.com/babyfish-ct/jimmer/blob/main/example/env-with-cache/maxwell), and execute
```
bash ./install.sh
```

After the installation is complete, the port occupation of the docker host is enabled as follows

|Container|Port|Description|
|-----|---|----|
|maxwell-demo-zookeeper|4000|Support Kafka, users will not use it directly|
|maxwell-demo-kafka|4100|The exposed address is localhost, i.e., assuming that the docker host is your local mechine. If you want to use a remote server as the docker host, you need to modify the kafka installation command in the install.sh and modify the spring-boot configuration file in the example|
|maxwell-demo-kafdrop|4101|A Kafka graphical interface tool that can be accessed with a browser http://localhost:4101|
|maxwell-demo-mysql|4200|Database service in this mode|
|maxwell-demo-maxwell|NA|Responsible for pushing MySQL change events to Kafka's background service|
|maxwell-demo-redis|4400|Cache service in this mode|

### Debezium + Postgres

[Debezium](https://debezium.io/) supports for many kinds of databases, with good commonality, examples use it to support postgres CDC.

:::info
Postgres is a very good open source database. If your project is brand new and doesn't have any historical baggage, consider trying Postgres. This is also why Jimmer's example uses debezium to support Postgres.
:::

Open the command line, change to the local directory corresponding to [example/env-with-cache/debezium](https://github.com/babyfish-ct/jimmer/blob/main/example/env-with-cache/debezium), and execute
```
bash ./install.sh
```

After the installation is complete, the port occupation of the docker host is enabled as follows

|Container|Port|Description|
|-----|---|----|
|debezium-demo-zookeeper|5000|Support Kafka, users will not use it directly|
|debezium-demo-kafka|5100|The exposed address is localhost, i.e., assuming that the docker host is your local mechine. If you want to use a remote server as the docker host, you need to modify the kafka installation command in the install.sh and modify the spring-boot configuration file in the example|
|debezium-demo-kafdrop|5101|A Kafka graphical interface tool that can be accessed with a browser http://localhost:5101|
|debezium-demo-postgres|5200|Database service in this mode|
|debezium-demo-connect|5300|The kafka-connector, which is responsible for pushing postgres change events to Kafka, can check whether the pg-connector named `debezium-connector` is successfully installed by http://localhost:5300/connectors|
|debezium-demo-redis|5400|Cache service in this mode|
    
## Notes
:::caution
If you install the external environment of `Maxwell + MySQL` and `Debezium + Postgres`, some containers may not be started due to insufficient memory.

Take my Mac as an example, by default, the Mac allocates 2GB of memory for docker, installs and starts all the above containers, plus several other containers that have nothing to do with it, resulting in insufficient memory, set to 3GB after the problem is solved.
:::

    

